function [transco2basl,wavenumbers] = transCO2corr2(M,type)%[transco2basl,wavenumbers] = transCO2corr2(M,type)%takes matrix M and corrects for CO2 interference%CO2 bands which are treated are:%2403.21 to 2272.06 (i.e. bins closest to 2400-2275)%682.77 to 655.77 (i.e. bins closest to 680-660)%when:%      type = 1, for 1764 bin data%      type = 2, for 1660 bin data%      type = 3,%%% Copyright (c) 1997, Royston Goodacre%                modified with the data 2004, Catherine Winder %to work out matrix dimensions[rows,cols]=size(M);  if type == 1    ut = lintrans([1:1764],1,1764,4000.21,601.767);     %to set a trend in the two CO2 bands%%for 1764 datatransco2basl1=zeros(rows,69);for i=1:rows   co2begin1=M(i,830);   co2end1=M(i,898);   slide1 = lintrans(1:69,1,69,co2begin1,co2end1);   transco2basl1(i,:)=slide1;end transco2basl2=zeros(rows,15);for i=1:rows   co2begin2=M(i,1722);   co2end2=M(i,1736);   slide2 = lintrans(1:15,1,15,co2begin2,co2end2);   transco2basl2(i,:)=slide2;end for i=1:rows   transco2basl(i,:)=[M(i,1:829)';transco2basl1(i,:)';M(i,899:1721)';transco2basl2(i,:)';M(i,1737:1764)']';end%take out first 200 bins;transco2basl = transco2basl(:,201:end);wavenumbers = ut(201:end);%%%for 1660 bin dataelseif type == 2transco2basl1=zeros(rows,41);for i=1:rows   co2begin1=M(i,840);   co2end1=M(i,880);   slide1 = lintrans(1:41,1,41,co2begin1,co2end1);   transco2basl1(i,:)=slide1;end transco2basl2=zeros(rows,15);for i=1:rows   co2begin2=M(i,1620);   co2end2=M(i,1634);   slide2 = lintrans(1:15,1,15,co2begin2,co2end2);   transco2basl2(i,:)=slide2;end for i=1:rows   transco2basl(i,:)=[M(i,1:839)';transco2basl1(i,:)';M(i,881:1619)';transco2basl2(i,:)';M(i,1635:1660)']';end wavenumbers = lintrans([1:1660],1,1660,4000.21,601.767);end